---
title: "DT_proof"
author: "Josh Soboil"
date: "13/09/2020"
output: 
 html_document:
  theme: readable
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(matlib)
```

#  An incoherent, Dutch Book series of bets:
```{r, echo = TRUE}
p1 <- .3
p2 <- .1
p3 <- .4
```
The set of probabilities do not meet the criterion P($A\cap, ...,\cap A$) = 1:
```{r, echo = TRUE}
sum(p1 + p2 + p3)
```
In matrix form:
```{r, echo = TRUE}
R <- matrix(c(1 - p1,   - p2,   - p3,
                - p1, 1 - p2,   - p3,
                - p1,   - p2, 1 - p3), 
            nrow = 3)
R
```
Notice matrix determinant > 0:
```{r, echo = TRUE}
det(R)
```

and that we can invert the matrix because because it is not singular:
```{r, echo = TRUE}
matrixcalc::is.singular.matrix(R)
matlib::inv(R)
```
therefore we can solve for the system G = Rs

First we give some arbitrary numerical stakes s to each probability event:
```{r, echo = TRUE}
s <- c(5, 2, 1)
s
```
Accordingly, if we solve for the system of linear equations, the gains for each bet
equal:
```{r, echo = TRUE}
G <- solve(a = R, b = s)
G
```
And notice that the sum of bets have a net positive gain of 2:
```{r, echo = TRUE}
round(sum(G))
```
Moreover, because this series of bets is inconsistent, we can solve for the system s = R^-1G, i.e. we can deduce a series of bets that will always lead to a positive gain:
```{r, echo = TRUE}
s_solved <- solve(a = inv(R), b = G)
s_solved
```
Again, this can be shown to work for any arbitrary size of stakes (bets):
```{r, echo = TRUE}
s <- c(20291, 213, 13512)
s
```
Now we can solve for the system of linear equations G = Rs, and deduce a system of stakes s that will enable net positive gains:
```{r, echo = TRUE}
G <- solve(a = R, b = s)
G

s_solved <- solve(a = inv(R), b = G)
s_solved
```

# A coherent series of bets:
```{r A coherent bet, echo = TRUE}
p1 <- .3
p2 <- .3
p3 <- .4
```
The set of probabilities do  meet the criterion P($A\cap, ...,\cap A$) = 1:
```{r, echo = TRUE}
sum(p1 + p2 + p3)
```
In matrix form:
```{r, echo = TRUE}
R <- matrix(c(1 - p1,   - p2,   - p3,
                - p1, 1 - p2,   - p3,
                - p1,   - p2, 1 - p3), 
            nrow = 3)
R
```
and we cannot invert the matrix, because it is a singular matrix with a determinant of zero:
```{r, echo = TRUE}
matrixcalc::is.singular.matrix(R)
det(R)
```
 Therefore, we cannot solve for the system s = R^-1G.
 
Nevertheless, for sake of further illustration, let us give arbitrary numerical stakes to each probabilistic event:
```{r, echo = TRUE}
s <- c(5, 2, 1)
s
```
Accordingly, if we solve for the system of linear equations, the gains for each bet
equal (we even have to revert to the %*% matrix operator)
```{r, echo = TRUE}
G <- R%*%s
G
```
Notice the net overall gains are 0:
```{r, echo = TRUE}
round(sum(G))
```

Now that the system is coherent, it will always result in a net gain of 0 for any arbitrary series of stakes (bets):
```{r, echo = TRUE}
s <- c(20291, 213, 13512)
s
```
Accordingly, if we solve for the system of linear equations, the gains for each bet
equal:
```{r, echo = TRUE}
G <- R%*%s
G
```
Again, notice the net overall gains are 0:
```{r, echo = TRUE}
round(sum(G))
```